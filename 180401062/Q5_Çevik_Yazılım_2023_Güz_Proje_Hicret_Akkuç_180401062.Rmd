---
title: "Proje Rapor : Hicret Akkuç 180401062"
output:
  html_document:
    df_print: paged
---

# Q1 : Problem tanımı

YummyNut isimli fıstık ezmesi üreten şirketimizin instagram hesabını canlandırmak amacıyla fıstık ezmesi ile yapılan pratik yemek tariflerinin videolarını hesabımızda paylaşmak istiyoruz.

# Q2 : Proje Amacı

Food.com Recipes and Interactions (<https://www.kaggle.com/datasets/shuyangli94/food-com-recipes-and-user-interactions?select=RAW_recipes.csv>) isimli dataseti kullanılarak 30 ve 30 dakikadan az süren tariflerin pratik yemek tarifleri olarak belirlenip bunlar içerisinden de fıstık ezmesi kullanılarak yapılan yemek tariflerine ulaşıp, bu tarifleri instagram hesabımızı canlandırmak için kullanmak istiyoruz.

# Q3 : Veri seti keşifsel analizi

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Veri dosyasını internetten indir ve git repo'sunun içine commitle
filename <- "RAW_recipes.csv"

# Dosyayi ithal et
library(readr)
myDF <- read_csv(filename)
```
`

Veri seti Kaggle web sitesinden indirilmiştir ve **readr::read_csv()** fonksiyonu kullanılarak **`r class(myDF)[[1]]`** tipinde bir değişkene ithal edilmiştir. Veri boyutları aşağıdaki gibidir :

-   Satir sayisi : `r nrow(myDF)`
-   Sütun sayisi : `r ncol(myDF)`

Veri setinin ön görsellemesi aşağıda verilmiştir.

```{r echo=FALSE, message=FALSE, warning=FALSE}
myDF
```
Food.com sitesinden elde edilmiş olan veri seti incelendiğinde istenilen ihtiyaca yönelik olan sütunları name, tags, ve ingredients olarak belirledim. Bu veri sütunları arasında eksik değerler bulunuyor mu diye inceledim ve name sütununun 1 tane eksik değeri olduğunu görerek o satırı sildim. Görüldüğü üzere description sütununda da eksik veriler mevcut ama o sütundaki değişkenler bizi ilgilendirmediği için silmiyorum.

```{r echo=FALSE, message=FALSE, warning=FALSE}
#str(myDF)
#veri setinde eksik veri var mı?
sapply(myDF,function(x) sum(is.na(x)))
# name'deki eksik veriyi görmek için
#missing_indices <- which(is.na(myDF$name))
#print(missing_indices)
# name sütunu eksik değer içeren satırları çıkar
cmyDF <- myDF[!is.na(myDF$name), ]
```



Tags sütunu içerisinde char tipinde bulunan "30-minutes-or-less" ve "15-minutes-or-less" etiketine sahip olan verileri filtreleyerek elde ettikten sonra bu verilerin ingredients sütunu içerisinde tipi char olan bilgilerden de "peanut butter" içeren verileri elde edeceğim.


```{r message=FALSE, warning=FALSE, include=FALSE}
testthat::test_file("Q3_tests_Hicret_Akkuç_180401062.R", SilentReporter)
```


# Q4 : Veri seti ön işlemesi

Veri setinde tags sütununda bulunan ve yapımı 30 ve 30 dakikadan az süren yemek tariflerini filtreledim.

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(pander)

# Yeni bir dataframe oluşturun
df <- data.frame(Name = cmyDF$name, Tags = cmyDF$tags, Ingredients = cmyDF$ingredients)

# 'Tags' sütununda '30' veya '15' içeren satırları bulma
test <- grep("30|15", df$Tags)

# Sadece '30' veya '15' içeren satırları içeren dataframe'i oluşturun
result_df <- df[test, ]

# Sonuçları görüntüle
pander::pander(head(result_df), sanitize.text.function = function(x) x, split.tables = Inf)

 
```

Bu işlemler sonucunda elde edilen veriler üzerinde tekrardan filtreleme yaparak yapımında fıstık ezmesi kullanılanları buldum.


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(pander)
#myDF
# Yeni bir dataframe oluşturun
df <- data.frame(Name = cmyDF$name, Tags = cmyDF$tags, Ingredients = cmyDF$ingredients)

# 'Tags' sütununda '30' veya '15' içeren satırları bulma
test <- grep("30|15", df$Tags)
# Boş bir dataframe oluşturun
result_df <- data.frame()

# Her bir indeksteki 'Ingredients' değerlerini kontrol etme ve peanut butter bulunanları döndürme
invisible(lapply(test, function(index) {
  test2 <- df[grepl("peanut butter", df$Ingredients[index]), ]
  if (nrow(test2) > 0) {
    result_df <<- rbind(result_df, df[index, ])
  }
}))

# Sonuçları görüntüle
pander::pander(head(result_df), sanitize.text.function = function(x) x, split.tables = Inf)
 
```


```{r message=FALSE, warning=FALSE, include=FALSE}
testthat::test_file("Q4_tests_Hicret_Akkuç_180401062.R", SilentReporter)
```






# Q5 : Veri mühendisliği

Pratik, fıstık ezmesi kullanılarak yapılan ve hem pratik hem de fıstık ezmesi kullanılarak yapılan tariflerin bütün veri setine oranı;

```{r echo=FALSE, message=FALSE, warning=FALSE}
 # "tags" sütunundaki "30" ve "15" içeren verilerin oranını hesapla
tags_30_15_ratio <- sum(grepl("30|15", cmyDF$tags)) / nrow(cmyDF)

# "ingredients" sütunundaki "peanut butter" içeren verilerin oranını hesapla
peanut_butter_ratio <- sum(grepl("peanut butter", cmyDF$ingredients)) / nrow(cmyDF)

# Hem "30" hem de "15" içeren, aynı zamanda "peanut butter" içeren verilerin oranını hesapla
both_ratio <- sum(grepl("30|15", cmyDF$tags) & grepl("peanut butter", cmyDF$ingredients)) / nrow(cmyDF)

# Grafik oluştur
library(ggplot2)

# Bar Grafik
ggplot(data = data.frame(category = c("Pratik", "Fıstık Ezmesi", "Pratik ve Fıstık Ezmesi"), 
                         ratio = c(tags_30_15_ratio, peanut_butter_ratio, both_ratio)), 
       aes(x = category, y = ratio, fill = category)) +
  geom_bar(stat = "identity") +
  labs(title = "Pratik ve Fıstık Ezmesi Kullanılarak Yapılan Tarifler",
       x = "Kategori",
       y = "Oran") +
  theme_minimal()

# Sayısal oranı cümle içinde ifade et
cat(sprintf("Toplam %d tarifin %.2f%%'sı pratik tariftir, %.2f%%'sı fıstık ezmesi içermekte ve %.2f%%'sı hem pratik hem de fıstık ezmesi kullanılarak yapılmıştır.",
            nrow(cmyDF), tags_30_15_ratio * 100, peanut_butter_ratio * 100, both_ratio * 100))
```

Grafikten de görüldüğü üzere istenilen veriler tüm veriler arasında sadece 1.21%'lik bir orana sahiptir. Yani bu dataset için konuşursam fıstık ezmesiyle hazırlanan tariflerin az olduğu görülmektedir.



```{r message=FALSE, warning=FALSE, include=FALSE}
testthat::test_file("Q5_tests_Hicret_Akkuç_180401062.R", SilentReporter)
```